class ScrollAppear{constructor(e={}){this.options={className:"appear",threshold:.1,rootMargin:"0px 0px -50px 0px",once:!0,duration:800,easing:"ease-out",animationType:"fadeUp",observeDOM:!0,debounceDelay:100,...e},this.elements=new Set,this.observer=null,this.mutationObserver=null,this.animations=new Map,this.debounceTimer=null,this.init()}init(){this.collectElements(),this.setupObserver(),this.checkInitiallyVisible(),this.options.observeDOM&&this.setupMutationObserver(),this.setupGlobalEvents()}collectElements(e=document){const t=e.querySelectorAll(`.${this.options.className}`);let s=0;return t.forEach((e=>{this.elements.has(e)||(this.elements.add(e),this.setInitialStyle(e),this.observer&&this.observer.observe(e),s++)})),s>0&&e!==document&&this.checkElementsInContainer(e),s}setupMutationObserver(){"MutationObserver"in window&&(this.mutationObserver=new MutationObserver((e=>{let t=!1;for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)if(1===e.nodeType&&this.hasAppearElements(e)){t=!0;break}t&&this.debouncedProcessNewElements()})),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0}))}hasAppearElements(e){return!(!e.classList||!e.classList.contains(this.options.className))||!(!e.querySelector||!e.querySelector(`.${this.options.className}`))}debouncedProcessNewElements(){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.processNewElements()}),this.options.debounceDelay)}processNewElements(){const e=this.elements.size;this.collectElements(),this.elements.size>e&&this.checkNewlyAddedElements()}checkNewlyAddedElements(){this.elements.forEach((e=>{!e.dataset.appeared&&this.isElementInViewport(e)&&this.animateElement(e)}))}checkElementsInContainer(e){setTimeout((()=>{e.querySelectorAll(`.${this.options.className}`).forEach((t=>{this.isElementVisibleInContainer(t,e)&&this.animateElement(t)}))}),50)}isElementVisibleInContainer(e,t){const s=t.getBoundingClientRect(),n=e.getBoundingClientRect();return n.top>=s.top&&n.bottom<=s.bottom&&null!==e.offsetParent}setupGlobalEvents(){document.addEventListener("scrollAppear:refresh",(()=>{this.refresh()})),document.addEventListener("scrollAppear:processContainer",(e=>{e.detail&&e.detail.container&&this.processContainer(e.detail.container)})),document.addEventListener("ajax:complete",(()=>{this.debouncedProcessNewElements()})),window.jQuery&&jQuery(document).on("ajaxComplete",(()=>{this.debouncedProcessNewElements()}))}processContainer(e){if("string"==typeof e&&(e=document.querySelector(e)),!e)return;this.collectElements(e)>0&&this.checkElementsInContainer(e)}setInitialStyle(e){if(e.dataset.appearInitialized)return;const t=window.getComputedStyle(e),s=t.transform,n=t.opacity;e.dataset.originalTransform="none"!==s?s:"",e.dataset.originalOpacity=n&&"0"!==n?n:"1";const i=e.dataset.animation||this.getAnimationTypeFromClass(e)||this.options.animationType;e.style.opacity="0",this.applyInitialTransform(e,i),e.dataset.appearInitialized="true"}getAnimationTypeFromClass(e){const t=Array.from(e.classList),s=["fade-up","fade-down","fade-left","fade-right","zoom-in","fade"];for(const e of s)if(t.includes(e))return e.replace("-","");return null}applyInitialTransform(e,t){const s=e.dataset.originalTransform||"";let n="";switch(t){case"fadeUp":case"fade-up":n="translateY(30px)";break;case"fadeDown":case"fade-down":n="translateY(-30px)";break;case"fadeLeft":case"fade-left":n="translateX(-30px)";break;case"fadeRight":case"fade-right":n="translateX(30px)";break;case"zoomIn":case"zoom-in":n="scale(0.8)";break;case"fade":default:n=""}const i=s+(s&&n?" ":"")+n;i&&(e.style.transform=i),e.style.transition||(e.style.transition=`opacity ${this.options.duration}ms ${this.options.easing}${n?", transform "+this.options.duration+"ms "+this.options.easing:""}`)}setupObserver(){"IntersectionObserver"in window?(this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?this.animateElement(e.target):this.options.once||this.hideElement(e.target)}))}),{threshold:this.options.threshold,rootMargin:this.options.rootMargin}),this.elements.forEach((e=>this.observer.observe(e)))):this.fallbackAnimation()}checkInitiallyVisible(){setTimeout((()=>{this.elements.forEach((e=>{this.isElementInViewport(e)&&this.animateElement(e)}))}),100)}isElementInViewport(e){const t=e.getBoundingClientRect(),s=window.innerHeight||document.documentElement.clientHeight;return t.top>=0&&t.top<=s*(1-this.options.threshold)&&null!==e.offsetParent}animateElement(e){if("true"===e.dataset.appeared)return;const t=this.getDelay(e),s=()=>{const t=e.dataset.originalTransform||"",s=e.dataset.originalOpacity||"1";e.style.opacity=s,e.style.transform=t,e.dataset.appeared="true",this.options.once&&this.observer&&this.observer.unobserve(e),e.dispatchEvent(new CustomEvent("appear",{detail:{element:e}}))};t>0?setTimeout(s,t):s()}getDelay(e){if(e.dataset.delay)return parseInt(e.dataset.delay);const t=Array.from(e.classList);for(const e of t)if(e.startsWith("delay-")){const t=e.replace("delay-","");return parseInt(t)}return 0}hideElement(e){if("true"!==e.dataset.appeared)return;e.style.opacity="0";const t=e.dataset.animation||this.getAnimationTypeFromClass(e)||this.options.animationType;this.applyInitialTransform(e,t),e.dataset.appeared="false"}fallbackAnimation(){let e=!1;const t=()=>{this.elements.forEach((e=>{"true"!==e.dataset.appeared&&this.isElementInViewport(e)&&this.animateElement(e)})),e=!1},s=()=>{e||(requestAnimationFrame(t),e=!0)};this.scrollHandler=s,window.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s,{passive:!0}),t()}refresh(){this.processNewElements()}show(e){"string"==typeof e&&(e=document.querySelector(e)),e&&this.animateElement(e)}hide(e){"string"==typeof e&&(e=document.querySelector(e)),e&&this.hideElement(e)}destroy(){this.observer&&this.observer.disconnect(),this.mutationObserver&&this.mutationObserver.disconnect(),this.scrollHandler&&(window.removeEventListener("scroll",this.scrollHandler),window.removeEventListener("resize",this.scrollHandler)),clearTimeout(this.debounceTimer),this.elements.forEach((e=>{e.style.opacity="",e.style.transform="",e.style.transition="",delete e.dataset.appearInitialized,delete e.dataset.appeared,delete e.dataset.originalTransform,delete e.dataset.originalOpacity})),this.elements.clear()}}function initScrollAppear(e){if("loading"===document.readyState){let t=null;return document.addEventListener("DOMContentLoaded",(()=>{t=new ScrollAppear(e),window.scrollAppearInstance=t})),t}{const t=new ScrollAppear(e);return window.scrollAppearInstance=t,t}}window.ScrollAppear=ScrollAppear,window.initScrollAppear=initScrollAppear,initScrollAppear(),window.processScrollAppear=e=>{window.scrollAppearInstance?window.scrollAppearInstance.processContainer(e):setTimeout((()=>{window.scrollAppearInstance||(window.scrollAppearInstance=new ScrollAppear),window.scrollAppearInstance.processContainer(e)}),100)};